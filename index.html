<!doctype html>
<html>
<head>
    <link rel="icon" href="images/favicon1.png">
    <title>Inbox - Memory_Match@gmail.com</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

    <script>
        var number_of_cards = null;
        var cardtracker = 1;
        var first_card_clicked = null;
        var second_card_clicked = null;
        var total_possible_matches=null
        var match_counter = 0;
        var first_card_element = null;
        var second_card_element = null;
        var clickable = true;
        var othercard1 = null;
        var othercard2 = null;

        function reset(){
            window.location.href=window.location.href;
        }

        function remove_pair(){
            console.log("remove pair");
            $('#'+othercard1).hide();
            console.log(othercard1+ "is hidden");

            $('#'+othercard2).hide();
            console.log(othercard2+ "is hidden");

            $('.backwait').addClass("back");
            $('.frontwait').addClass("front");
            $('.back').removeClass("backwait");
            $('.front').removeClass("frontwait");

            othercard1=null;
            othercard2=null;
            clickable = true;

            if (total_possible_matches == match_counter) {
                console.log("winner!")
                $('#message').text("Congratulations, you won... heres an e-cookie.")
                $('#messagewindow').show();
            }
        }
        function setcardnumber(elm){
            number_of_cards=elm;
            total_possible_matches=elm/2;
            $('#easy').hide();
            $('#medium').hide();
            $('#hard').hide();

        }
        function hide_window() {
            $('#messagewindow').hide();
        }

        function flip_back() {
            console.log("flipping back, i guessed wrong")
            $(second_card_element).css('display', 'initial');
            $(first_card_element).css('display', 'initial');
            first_card_element = null;
            second_card_element = null;
            clickable = true;
            $('.backwait').addClass("back");
            $('.frontwait').addClass("front");
            $('.back').removeClass("backwait");
            $('.front').removeClass("frontwait");

        }
        ;
        function inbox_counter() {
            var total = number_of_cards - match_counter * 2;
            var counter = $('<p>').text("Inbox (" + total + ")");
            $("#inbox p").replaceWith(counter);
        }

        function flip(element) {
            if (clickable == true) {
                console.log("flip!");
                $(element).css('display', 'none');

                if (cardtracker == 1) {
                    cardtracker++;
                    console.log("next card clicked will be " + cardtracker);
                    first_card_clicked = $(element).text();
                    first_card_element = element;
                }
                else if (cardtracker == 2) {
                    cardtracker--;
                    console.log("next card clicked will be " + cardtracker);
                    second_card_clicked = $(element).text();
                    second_card_element = element;
                    if (first_card_clicked == second_card_clicked) {

                        $('.back').addClass("backwait");
                        $('.front').addClass("frontwait");
                        $('.back').removeClass("back");
                        $('.front').removeClass("front");

                        match_counter++;
                        inbox_counter();

                        othercard1 = second_card_clicked;
                        othercard2 = parseInt(second_card_clicked)+1;
                        clickable=false;
                        setTimeout(remove_pair, 2000);
                        first_card_clicked = null;
                        second_card_clicked = null;

                    } else if (first_card_clicked != second_card_clicked) {
                        clickable = false;
                        console.log("clickable is now: " + clickable);

                        $('.back').addClass("backwait");
                        $('.front').addClass("frontwait");
                        $('.back').removeClass("back");
                        $('.front').removeClass("front");

                        setTimeout(flip_back, 2000);
                        first_card_clicked = null;
                        second_card_clicked = null;
                    }
                }
            }
            else {
                return;
            }
        }

        function genCards() {
            console.log("generating cards");
            for (i = 1; i <= number_of_cards; i++) {
                var new_card = $("<div class='card' id='" + i + "'>");
                $("#game-area").append(new_card);

            }
        }
        function genfrontback() {
            console.log("generating front and back");
            for (i = 1, x = 1; i <= number_of_cards; i++, x++) {
                if (x % 2 == true) {
                    var new_face = $("<div class='front'>").text(x);
                    var new_back = $("<div class='back' onclick='flip(this)'>").text(x);
                }
                else if (x % 2 == 0) {
                    var new_face = $("<div class='front'>").text(x - 1);
                    var new_back = $("<div class='back' onclick='flip(this)'>").text(x - 1);
                }
                $('#' + i).append(new_face, new_back);
            }
        }
    </script>
</head>
<body>

<header>
    <div id="header1">
        <div id="logo"></div>
        <div id="aboutme" style="cursor: pointer;" onclick="window.location='about.html';"><h4>About</h4></div>
    </div>
    <div id="header2">
        <div id="logo2"></div>
        <div id="settings" style="cursor: pointer;" onclick="window.location='#';"><h4>Settings</h4></div>
    </div>
</header>

<!--emtpy space for my header -->
<div class="headerspace">
</div>

<div class="sidebar">
    <div id="stats">
        <div class="reset" style="cursor: pointer;" onclick="reset()">
            <p>RESET GAME</p>
        </div>
        <div id="inbox"><p>Inbox</p></div>
        <div class="games-played">
            <div class="label">Games Played</div>
            <div class="value"></div>
        </div>
        <div class="attemps">
            <div class="label">Attemps</div>
            <div class="value"></div>
        </div>
        <div class="accuracy">
            <div class="label">Accuracy</div>
            <div class="value"></div>
        </div>
        <div class="draft">Drafts (2)
        </div>
    </div>
    <img src="images/siderbar.JPG">
</div>

<!--card landing zone -->
<div id="game-area">
    <img src="images/header3.JPG">
</div>

<div id="messagewindow">
    <div id="head">
        <p>New Message</p>
        <div id="x" onclick="hide_window()">

        </div>
    </div>

    <div id="message">
        Skynet: Welcome to Gmail Memory Match!<br><br>
        Gmail Memory Match is Skynet's take on the classic game of concentration. The
        goal of the game is to clear your inbox, you can do this by matching 2 emails with the same message.<br><br>
        Select your difficulty on the bottom left of this window to begin!<br><br><br>

        <img src="images/GoogleSkynet3.jpg">
    </div>

    <div id="foot">
        <div id="easy" onclick="setcardnumber(10);hide_window();genCards();genfrontback();inbox_counter();">
           <p>Easy</p>
        </div>
        <div id="medium" onclick="setcardnumber(18);hide_window();genCards();genfrontback();inbox_counter();">
            <p>Medium</p>
        </div>
        <div id="hard" onclick="setcardnumber(1456);hide_window();genCards();genfrontback();inbox_counter();">
           <p>Good luck...</p>
        </div>
    </div>
</div>

</body>
</html>